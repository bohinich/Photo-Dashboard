{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst BASE_URL = \"https://pixabay.com/api/\";\nconst API_KEY = \"49365626-6bf9b0bb5948f971197bdaec6\";\n\nconst pixabayApi = axios.create({\n    baseURL: BASE_URL,\n    params: {\n        key: API_KEY,\n        image_type: \"photo\",\n        orientation: \"horizontal\",\n        safesearch: true,\n    },\n})\n\nexport async function getImagesByQuery(query, page = 1, perPage = 15) {\n    try {\n        const response = await pixabayApi.get(\"\", {\n            params: {\n                q: query,\n                page: page,\n                per_page: perPage,\n            },\n        });\n\n        return response.data;\n    } catch (error) {\n        console.error(\"Error fetching images:\", error);\n\n        throw error;\n    }\n}","export function createGalleryMarkup(images) {\n    return images\n        .map(\n            ({\n                webformatURL,\n                largeImageURL,\n                tags,\n                likes,\n                views,\n                comments,\n                downloads,\n            }) => {\n                return `\n                    <li class=\"gallery-item\">\n                        <a href=\"${largeImageURL}\" class=\"gallery-link\">\n                            <img src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" class=\"gallery-image\"/>\n                        </a>\n\n                        <div class=\"info\">\n                            <p><b>Likes</b> ${likes}</p>\n                            <p><b>Views</b> ${views}</p>\n                            <p><b>Comments</b> ${comments}</p>\n                            <p><b>Downloads</b> ${downloads}</p>\n                        </div>\n                    </li>`\n            }\n        )\n        .join(\"\")\n}\n\nexport function appendImages(galleryEl, markup) {\n    galleryEl.insertAdjacentHTML(\"beforeend\", markup)\n}\n\nexport function clearGallery(galleryEl) {\n    galleryEl.innerHTML = \"\"\n}","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { getImagesByQuery } from \"./js/pixabay-api\";\nimport { createGalleryMarkup, appendImages, clearGallery, } from \"./js/render-functions\";\n\nconst form = document.querySelector(\".search-form\");\nconst gallery = document.querySelector(\".gallery\");\nconst loadMoreBtn = document.querySelector(\".load-more\");\nconst loader = document.querySelector(\".loader\");\n\nlet currentQuery = \"\";\nlet currentPage = 1;\nconst perPage = 15;\nlet totalHits = 0;\n\nform.addEventListener(\"submit\", handleSubmit);\n\nasync function handleSubmit(event) {\n    event.preventDefault();\n\n    const query = event.target.elements.query.value.trim();\n\n    if (!query) {\n        iziToast.warning({\n            message: \"Please enter a search query\",\n            position: \"topRight\",\n        });\n        return\n    }\n\n    currentQuery = query;\n    currentPage = 1;\n    totalHits = 0;\n\n    clearGallery(gallery);\n    hideLoader();\n\n    try {\n        showLoader();\n\n        const data = await getImagesByQuery(currentQuery, currentPage, perPage);\n\n        totalHits = data.totalHits;\n\n        if (data.hits.length === 0) {\n            iziToast.warning({\n                message: \"No images found\",\n                position: \"topRight\",\n            });\n            return\n        }\n\n        const markup = createGalleryMarkup(data.hits);\n        appendImages(gallery, markup);\n\n        checkEndOfCollection();\n    } catch (error) {\n        iziToast.warning({\n            message: \"Something went wrong. Please try again\",\n            position: \"topRight\",\n        });\n    } finally {\n        hideLoader()\n    }\n}\n\nloadMoreBtn.addEventListener(\"click\", handleLoadMore);\n\nasync function handleLoadMore() {\n    currentPage += 1;\n\n    try {\n        showLoader\n\n        const data = await getImagesByQuery(currentQuery, currentPage, perPage);\n\n        const markup = createGalleryMarkup(data.hits);\n        appendImages(gallery, markup);\n\n        checkEndOfCollection();\n\n        const { height: cardHeight } = gallery.firstElementChild.getBoundingClientRect();\n\n        window.scrollBy({\n            top: cardHeight * 2,\n            behavior: \"smooth\",\n        });\n    } catch (error) {\n        iziToast.warning({\n            message: \"Error loading more images\",\n            position: \"topRight\",\n        });\n    } finally {\n        hideLoader();\n    }\n}\n\nfunction checkEndOfCollection() {\n    const loadedImages = currentPage * perPage;\n\n    if (loadedImages > totalHits) {\n        hideLoadMore();\n        iziToast.warning({\n            message: \"You've reached the end of the results\",\n            position: \"topRight\",\n        });\n    } else {\n        showLoadMore();\n    }\n}\n\nfunction showLoader() {\n    loader.classList.remove(\"hidden\");\n}\n\nfunction hideLoader() {\n    loader.classList.add(\"hidden\");\n}\n\nfunction showLoadMore() {\n    loadMoreBtn.classList.remove(\"hidden\");\n}\n\nfunction hideLoadMore() {\n    loadMoreBtn.classList.add(\"hidden\");\n}"],"names":["BASE_URL","API_KEY","pixabayApi","axios","getImagesByQuery","query","page","perPage","error","createGalleryMarkup","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","appendImages","galleryEl","markup","clearGallery","form","gallery","loadMoreBtn","loader","currentQuery","currentPage","totalHits","handleSubmit","event","iziToast","hideLoader","showLoader","data","checkEndOfCollection","handleLoadMore","cardHeight","hideLoadMore","showLoadMore"],"mappings":"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"}